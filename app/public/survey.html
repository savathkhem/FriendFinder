<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FriendAllocator</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css">

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <link rel="stylesheet" href="public/css/style.css">

    <style>
        .container {
            background-color: #558b2f;
            border-radius: 15px;
            padding: 20px;
            width: 500px;
        }

        .btn {
            color: #1b5e20;
        }

        .btn-floating {
            color: #1b5e20;
        }
    </style>

</head>

<body>
    <main>
    <div class='card-panel grey lighten-2 col s12'>
        <div class="container">
            <h2 class="center survey">Survey Questions</h2>
            <hr>
            <h6>About You</h6>
            <div class="row">
                <form class="col s12" id="myForm">
                    <div class="row">
                        <div class="input-field col s12">
                            <input id="name" type="text" class="validate formInput" required>
                            <label for="password">Name</label>
                        </div>
                    </div>
                    <div class="row last">
                        <div class="input-field col s12">
                            <input id="pic" type="text" class="validate formInput" required>
                            <label for="email">Photo</label>
                        </div>
                    </div>
                    <div class="row">
                        <h6>Question 1</h6>
                        <label>Do you like cake?</label>
                        <div class="input-field col s12">
                            <select class="chosen" id="q1">
                                <option value="" disabled selected>Choose your option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <h6>Question 2</h6>
                        <label>Do you hate cake?</label>
                        <div class="input-field col s12">
                            <select class="chosen" id="q2">
                                <option value="" disabled selected>Choose your option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <h6>Question 3</h6>
                        <label>Do you like milk?</label>
                        <div class="input-field col s12">
                            <select class="chosen" id="q3">
                                <option value="" disabled selected>Choose your option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <h6>Question 4</h6>
                        <label>Do you drink milk with cake?</label>
                        <div class="input-field col s12">
                            <select class="chosen" id="q4">
                                <option value="" disabled selected>Choose your option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <h6>Question 5</h6>
                        <label>Do you want to stop this survery?</label>
                        <div class="input-field col s12">
                            <select class="chosen" id="q5">
                                <option value="" disabled selected>Choose your option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <h6>Question 6</h6>
                        <label>Do you think we will find you a friend?</label>
                        <div class="input-field col s12">
                            <select class="chosen" id="q6">
                                <option value="" disabled selected>Choose your option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <h6>Question 7</h6>
                        <label>Are you doubting our state of the art friend designation algorithm?</label>
                        <div class="input-field col s12">
                            <select class="chosen" id="q7">
                                <option value="" disabled selected>Choose your option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <h6>Question 8</h6>
                        <label>Do you think there will be cake after you answer the last question?</label>
                        <div class="input-field col s12">
                            <select class="chosen" id="q8">
                                <option value="" disabled selected>Choose your option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <h6>Question 9</h6>
                        <label>How dissapointed are you right now that there is no cake?</label>
                        <div class="input-field col s12">
                            <select class="chosen" id="q9">
                                <option value="" disabled selected>Choose your option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <h6>Question 10</h6>
                        <label>You generally stay relaxed under pressure</label>
                        <div class="input-field col s12">
                            <select class="chosen" id="q10">
                                <option value="" disabled selected>Choose your option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>
                        </div>
                    </div>
                    <button class="green darken-4 btn-large waves-effect waves-light" type="submit" name="action" id="submit">Submit
                        <i class="material-icons right green darken-4">settings_input_svideo</i>
                    </button>
                </form>
            </div>
        </div>
    </div>
    </main>

    <!-- MODAL AREA -->
    <div id="modal1" class="modal">
        <div class="modal-header">
            <a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat">CLOSE</a>
        </div>
        <div class="modal-content center-align">
            <h3>Your Best Friend Is</h3>
            <hr>
            <h6 id="matchName"></h6>
            <img id="matchImg" onError="this.src='https://blog.sqlauthority.com/i/a/errorstop.png'" height="300px" width="300px"></img>
        </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js"></script>
    <script>
        $(document).ready(function () {
            $('select').material_select();
        });
    </script>
    <script>
        $("#submit").on("click", function () {
            // Form validation
            function validateForm() {
                var isValid = true;
                $('.formInput').each(function () {
                    console.log($(this).val());
                    if ($(this).val() === '')
                        isValid = false;
                    console.log(isValid);
                });
                $('.chosen').each(function () {
                    console.log($(this).val());
                    if ($(this).val() == null)
                        isValid = false;
                    console.log(isValid);
                });
                return isValid;
            }
            // If all required fields are filled
            if (validateForm() == true) {
                // Create an object for the user's data
                var userData = {
                    name: $("#name").val(),
                    photo: $("#pic").val(),
                    scores: [$("#q1").val(), $("#q2").val(), $("#q3").val(), $("#q4").val(), $("#q5").val(),
                        $("#q6").val(), $("#q7").val(), $("#q8").val(), $("#q9").val(), $("#q10").val(),
                    ]
                }
                // Grab the URL of the website
                var currentURL = window.location.origin;
                // AJAX post the data to the friends API. 
                $.post(currentURL + "/api/friend", userData, function (data) {
                    // Grab the result from the AJAX post so that the best match's name and photo are displayed.
                    $("#matchName").text(data.name);
                    $('#matchImg').attr("src", data.photo);
                    // Show the modal with the best match 
                    $("#modal1").openModal();
                });
                $("#name").val("");
                $("#pic").val("");
                var x = document.getElementById("myForm");
                x.reset();
                $("#name").focus();
            } else {
                alert("Please fill out all fields before submitting!");
            }
            return false;
        });
    </script>
</body>

</html>